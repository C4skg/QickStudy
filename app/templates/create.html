{% extends "themes/base.html" %}
{% block extends %}
    <link rel="stylesheet" href="{{ url_for('themes.static',path='Vditor/index.css') }}">
    <link rel="stylesheet" href="{{ url_for('themes.static',path='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('themes.static',path='css/create.css') }}">
    <script src="{{ url_for('themes.static',path='Vditor/index.min.js') }}"></script>
    <script src="{{ url_for('themes.static',path='js/create.js') }}"></script>
{% endblock %}
{% block title %}
 - 在线 markdown 编辑器
{% endblock %}
{% block hscript %}
<script>
    window.csrf_token = "{{ csrf_token() }}"
    window.upload_url = "{{ url_for('server.upload') }}"
    window.user = {
        username: "{{ user.username }}",
        logo: "{{ url_for('server.logo') }}"

    }
</script>
{% endblock %}
{% block body %}
    <div id="ready" hidden>{{article.context}}</div>
    <div class="container-fluid main card">
        <div class="container">
            <form class="SubmitForm">
                <div class="head">
                    <div class="title">发布文章</div>
                    <div class="func">
                        <div class="markdown small text-muted noselect" title="markdown 语法可用" data-bs-toggle="tooltip">
                            markdown 语法已启用
                        </div>
                        
                            <div class="type d-flex">
                                <input type="hidden" value="{{ csrf_token() }}" name="csrf_token" />
                                <select class="form-select form-select-sm" name="type">
                                    <option value="1">草稿</option>
                                    <option value="2">发布</option>
                                </select>
                                <button type="button" class="btn btn-primary btn-sm no-wrap" id="release">保 存</button>
                            </div>
                    </div>
                </div>
                <div class="articleInfos card container">
                    <div class="title">
                        <input id="title"  type="text" placeholder="在这里输入文章标题" name="title" oninput="titleCount()" value="{{ article.title }}">
                        <label for="title">
                            {{article.title | length}}/100
                        </label>
                    </div>
                    <div class="extend">
                        <div class="fm" data-status="normal" onclick="setCover()">
                            <div class="position-center">
                                <span class="spinner-border spinner-border-sm"></span>上传中
                            </div>                    
                            <input id="cover" class="hidden" type="file" accept="image/*" name="file" value="">
                            <picture>
                                {% if article.cover %}
                                <img src="{{ article.cover }}" alt="">
                                {% else %}
                                <img src="{{ url_for('themes.static',path='/img/default.png') }}" alt="">
                                {% endif %}
                            </picture>   
                        </div>
                        <div class="desc">
                            <div class="txt">
                                <div class="main">设置文章封面图片</div>
                                <div class="second small text-muted noselect">图片要求: JPG、PNG</div>
                            </div>
                            <div class="btn btn-secondary" onclick="setCover()">
                                上传封面
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- ^Vditor -->
        <div id="vditor"></div>
    </div>
{% endblock %}
</html>